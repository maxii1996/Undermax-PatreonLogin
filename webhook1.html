<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ko‑fi Webhook Receiver</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f7f7f7;
      padding: 20px;
    }
    #content {
      background: #fff;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    pre {
      background: #eee;
      padding: 10px;
      border-radius: 3px;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <div id="content">
    <h1>Ko‑fi Webhook Receiver</h1>
    <div id="result">Esperando datos...</div>
  </div>
  <script>
    // Debido a que GitHub Pages es estático y no puede recibir solicitudes POST,
    // para propósitos de prueba se pueden enviar datos vía query string.
    // Ejemplo de uso:
    // https://maxii1996.github.io/Undermax-PatreonLogin/webhook.html?data=%7B%22verification_token%22%3A%226f36f107-c63e-4fbb-a3b5-0a67ba76d4b2%22%2C%22type%22%3A%22Subscription%22%2C%22subscription_active%22%3Atrue%7D

    function getQueryParams() {
      let params = {};
      window.location.search.substring(1).split('&').forEach(function(pair) {
        if (pair) {
          var parts = pair.split('=');
          params[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1] || '');
        }
      });
      return params;
    }
    window.onload = function() {
      var params = getQueryParams();
      var resultDiv = document.getElementById("result");
      if (params.data) {
        try {
          var data = JSON.parse(params.data);
          // Verificar el verification token
          var expectedToken = "6f36f107-c63e-4fbb-a3b5-0a67ba76d4b2";
          if (data.verification_token !== expectedToken) {
            resultDiv.innerHTML = "<p>Error: Token de verificación inválido.</p>";
            return;
          }
          resultDiv.innerHTML = "<h2>Datos recibidos:</h2><pre>" + JSON.stringify(data, null, 2) + "</pre>";
        } catch (e) {
          resultDiv.innerHTML = "<p>Error al parsear los datos: " + e.message + "</p>";
        }
      } else {
        resultDiv.innerHTML = "<p>No se recibieron datos.</p>";
      }
    };
  </script>
</body>
</html>
